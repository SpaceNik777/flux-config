apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: elk
  namespace: flux-system
spec:
  targetNamespace: elk
  interval: 24h
  timeout: 10m
  releaseName: elk
  chart:
    spec:
      sourceRef:
        kind: HelmRepository
        name: bitnami
        namespace: flux-system
      chart: elasticsearch
  install:
    createNamespace: true
    remediation:
      retries: 3
  upgrade:
    remediation:
      retries: 3
  values:
    global:
      kibanaEnabled: true
    security:
      enabled: false
      elasticPassword: "<PASSWORD>"
      tls:
        autoGenerated: true
    kibana:
      elasticsearch:
        security:
          auth:
            enabled: false
            kibanaUsername: "<USERNAME>"
            kibanaPassword: "<PASSWORD>"
          tls:
            enabled: false
            existingSecret: RELEASENAME-elasticsearch-coordinating-crt
            usePemCerts: true
    master:
      masterOnly: false
      replicaCount: 1
    data:
      replicaCount: 0
    coordinating:
      replicaCount: 0
    ingest:
      replicaCount: 0